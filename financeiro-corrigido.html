<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MEGAVISION â€” Financial Pro</title>

  <!-- 1. Supabase PRIMEIRO -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- 2. MÃ³dulo central -->
  <script src="megavision-data.js"></script>
  <!-- 3. Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* sÃ³ CSS aqui, nada de HTML */
    @import url('https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@400;500;600&display=swap');

:root {
  --mv-bg:        #0a0a0f;
  --mv-surface:   #111118;
  --mv-border:    #1e1e2e;
  --mv-accent:    #7c3aed;
  --mv-accent2:   #06b6d4;
  --mv-gold:      #f59e0b;
  --mv-text:      #e2e8f0;
  --mv-muted:     #64748b;
  --mv-success:   #10b981;
  --mv-danger:    #ef4444;
  --mv-radius:    12px;
}

body {
  background: var(--mv-bg) !important;
  color: var(--mv-text) !important;
  font-family: 'DM Sans', sans-serif !important;
}

/* NAVBAR */
.mv-nav {
  position: sticky !important; top: 0 !important; z-index: 100 !important;
  background: rgba(10,10,15,0.95) !important;
  backdrop-filter: blur(16px) !important;
  border-bottom: 1px solid var(--mv-border) !important;
  padding: 0 28px !important;
  display: flex !important; align-items: center !important;
  justify-content: space-between !important;
  height: 60px !important;
}
.mv-nav-logo {
  font-family: 'Syne', sans-serif !important;
  font-weight: 800 !important; font-size: 18px !important;
  background: linear-gradient(135deg, var(--mv-accent), var(--mv-accent2)) !important;
  -webkit-background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
  text-decoration: none !important; letter-spacing: 1px !important;
}
.mv-nav-links { display: flex !important; gap: 6px !important; align-items: center !important; }
.mv-nav-links a {
  color: var(--mv-muted) !important; text-decoration: none !important;
  font-size: 13px !important; font-weight: 500 !important;
  padding: 6px 14px !important; border-radius: 8px !important; transition: all .2s !important;
}
.mv-nav-links a:hover { color: var(--mv-text) !important; background: var(--mv-border) !important; }
.mv-nav-status { display: flex !important; align-items: center !important; gap: 8px !important; font-size: 12px !important; color: var(--mv-muted) !important; }
.mv-dot { width: 8px !important; height: 8px !important; border-radius: 50% !important; background: var(--mv-success) !important; animation: pulse 2s infinite !important; }
.mv-dot.offline { background: var(--mv-danger) !important; animation: none !important; }

@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.4} }

/* APP CONTAINER */
#app {
  max-width: 1280px !important;
  margin: 0 auto !important;
  padding: 32px 28px 60px !important;
}

/* CARDS â€” o render() do financeiro gera divs, vamos estilizar globalmente */
#app > div, #app section, #app .card {
  background: var(--mv-surface) !important;
  border: 1px solid var(--mv-border) !important;
  border-radius: var(--mv-radius) !important;
  color: var(--mv-text) !important;
}

/* TEXTOS */
#app h1, #app h2, #app h3, #app h4 {
  font-family: 'Syne', sans-serif !important;
  color: var(--mv-text) !important;
}
#app p, #app span, #app label {
  color: var(--mv-text) !important;
}

/* INPUTS */
#app input, #app select, #app textarea {
  background: var(--mv-bg) !important;
  border: 1px solid var(--mv-border) !important;
  border-radius: 8px !important;
  color: var(--mv-text) !important;
  padding: 10px 14px !important;
  outline: none !important;
}
#app input:focus, #app select:focus {
  border-color: var(--mv-accent) !important;
}

/* BOTÃ•ES */
#app button {
  border-radius: 8px !important;
  font-weight: 600 !important;
  cursor: pointer !important;
  transition: all .2s !important;
}

/* TABELAS */
#app table { width: 100% !important; border-collapse: collapse !important; }
#app th {
  background: var(--mv-border) !important;
  color: var(--mv-muted) !important;
  font-size: 11px !important; text-transform: uppercase !important;
  padding: 12px 16px !important; text-align: left !important;
}
#app td {
  padding: 12px 16px !important;
  border-bottom: 1px solid var(--mv-border) !important;
  color: var(--mv-text) !important;
}
#app tr:hover td { background: rgba(124,58,237,.06) !important; }

/* MODAL */
.modal {
  display: none !important; position: fixed !important; inset: 0 !important;
  background: rgba(0,0,0,.75) !important; z-index: 200 !important;
  align-items: center !important; justify-content: center !important;
}
.modal.ativo { display: flex !important; }
.modal-content {
  background: var(--mv-surface) !important;
  border: 1px solid var(--mv-border) !important;
  border-radius: var(--mv-radius) !important;
  width: 90% !important; max-width: 560px !important;
  max-height: 90vh !important; overflow-y: auto !important;
}

/* FOOTER */
.mv-footer {
  text-align: center !important; padding: 24px !important;
  border-top: 1px solid var(--mv-border) !important;
  color: var(--mv-muted) !important; font-size: 12px !important;
  background: var(--mv-bg) !important;
}
.mv-footer span {
  background: linear-gradient(135deg, var(--mv-accent), var(--mv-accent2)) !important;
  -webkit-background-clip: text !important;
  -webkit-text-fill-color: transparent !important;
  font-weight: 700 !important;
}

/* CORES TAILWIND que usam bg- customizadas â€” forÃ§ar tom escuro */
[class*="bg-cm-"] { background: var(--mv-surface) !important; }
[class*="text-cm-"] { color: var(--mv-text) !important; }
[class*="border-cm-"] { border-color: var(--mv-border) !important; }


    /* Cards de tÃ©cnicas â€” fundo claro do Tailwind â†’ MEGAVISION escuro */
.bg-blue-50, .bg-green-50, .bg-yellow-50,
.bg-red-50, .bg-gray-50, .bg-white {
  background: var(--mv-surface) !important;
  color: var(--mv-text) !important;
}

/* Bordas coloridas dos cards */
.border-blue-400  { border-color: var(--mv-accent2) !important; }
.border-green-400 { border-color: var(--mv-success) !important; }
.border-yellow-400{ border-color: var(--mv-gold) !important; }
.border-red-400   { border-color: var(--mv-danger) !important; }

/* Textos coloridos dentro dos cards */
.text-blue-700, .text-blue-600, .text-blue-800 { color: var(--mv-accent2) !important; }
.text-green-700, .text-green-600 { color: var(--mv-success) !important; }
.text-yellow-700, .text-yellow-600 { color: var(--mv-gold) !important; }
.text-red-700, .text-red-600 { color: var(--mv-danger) !important; }
.text-gray-600, .text-gray-700, .text-gray-800 { color: var(--mv-muted) !important; }
.text-gray-900 { color: var(--mv-text) !important; }

/* Gradientes claros â†’ escuro */
.from-blue-50, .to-blue-50,
.from-green-50, .to-green-50 { 
  --tw-gradient-from: var(--mv-surface) !important;
  --tw-gradient-to: var(--mv-bg) !important;
}
  </style>
</head>
  
    <div id="app"></div>
    
    <button onclick="app.paginaAtual='dashboard';app.render();" 
        class="fixed bottom-6 right-6 bg-gradient-to-r from-cm-laranja to-cm-laranja-escuro hover:from-cm-verde-escuro hover:to-cm-verde-claro text-white p-4 rounded-full shadow-2xl transform hover:scale-110 transition-all z-50 border-4 border-white">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
        </svg>
    </button>

    <div id="modalTransacao" class="modal">
        <div class="modal-content">
            <div class="bg-cm-escuro text-white p-6 rounded-t-xl">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold" id="tituloModalTransacao">Nova TransaÃ§Ã£o</h2>
                    <button onclick="app.fecharModal('modalTransacao')" class="text-white text-3xl">&times;</button>
                </div>
            </div>
            <div class="p-6" id="conteudoModalTransacao"></div>
        </div>
    </div>

    <div id="modalMeta" class="modal">
        <div class="modal-content">
            <div class="bg-cm-escuro text-white p-6 rounded-t-xl">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold">ğŸ¯ Definir Meta Financeira</h2>
                    <button onclick="app.fecharModal('modalMeta')" class="text-white text-3xl">&times;</button>
                </div>
            </div>
            <div class="p-6" id="conteudoModalMeta"></div>
        </div>
    </div>
    
    <script>
const TECNICAS_ALAVANCAGEM={curto_prazo:{titulo:"Alavancagem de Curto Prazo (7-30 dias)",tecnicas:[{nome:"Regra 50/30/20 Turbo",descricao:"50% Essencial | 30% Investimento/DÃ­vidas | 20% Estilo de Vida",acao:"Inverta prioridades: pague dÃ­vidas e invista ANTES de gastar",impacto:"Reduz juros e acelera patrimÃ´nio em 3-6 meses"},{nome:"Efeito Bola de Neve (Snowball)",descricao:"Pague menor dÃ­vida primeiro, depois use esse valor na prÃ³xima",acao:"Liste dÃ­vidas da menor para maior. Ataque a menor com tudo",impacto:"MotivaÃ§Ã£o psicolÃ³gica + libertaÃ§Ã£o progressiva"},{nome:"MÃ©todo Avalanche",descricao:"Pague dÃ­vida com MAIOR juros primeiro",acao:"Calcule juros reais. Elimine cartÃ£o/cheque especial primeiro",impacto:"Economia mÃ¡xima de juros (pode ser 40%+ ao ano)"},{nome:"Renda Extra Direcionada",descricao:"100% da renda extra vai para meta especÃ­fica",acao:"Freela, venda, bico = direto para dÃ­vida ou investimento",impacto:"Acelera metas em 2-3x"},{nome:"Desafio Sem Gastos (No Spend Challenge)",descricao:"7-30 dias sem gastos nÃ£o essenciais",acao:"Congele cartÃµes, use sÃ³ dinheiro, zero delivery/uber",impacto:"Economiza 20-40% da renda facilmente"},{nome:"AutomatizaÃ§Ã£o Financeira",descricao:"Automatize investimento/pagamento no dia do salÃ¡rio",acao:"Configure dÃ©bito automÃ¡tico para poupanÃ§a/investimento",impacto:"Remove tentaÃ§Ã£o, garante disciplina"}]},medio_prazo:{titulo:"Alavancagem de MÃ©dio Prazo (1-6 meses)",tecnicas:[{nome:"Reserva de EmergÃªncia MÃ­nima",descricao:"3-6 meses de despesas essenciais",acao:"Calcule despesas fixas Ã— 3. Meta: acumular em 6 meses",impacto:"SeguranÃ§a para nÃ£o voltar a se endividar"},{nome:"RenegociaÃ§Ã£o Agressiva",descricao:"Negocie TUDO: dÃ­vidas, planos, assinaturas",acao:"Ligue para cada credor. PeÃ§a 50-70% desconto Ã  vista",impacto:"Reduz dÃ­vida total em 30-60%"},{nome:"MÃºltiplas Fontes de Renda",descricao:"2-3 fontes de renda paralelas",acao:"Monetize habilidade: aulas, freela, digital",impacto:"Aumenta renda em 30-100%"}]},regras_ouro:["ğŸ’° Pague a SI MESMO primeiro - separe investimento antes de gastar","ğŸ”¥ Juros compostos trabalham a SEU FAVOR ou CONTRA vocÃª","ğŸ“Š Acompanhe DIARIAMENTE - 5min/dia salva seu futuro","ğŸ¯ Meta sem prazo = sonho. Prazo sem aÃ§Ã£o = ilusÃ£o","âš¡ AÃ§Ã£o imperfeita HOJE > plano perfeito amanhÃ£","ğŸš« DÃ­vida de consumo Ã© VENENO. DÃ­vida de investimento Ã© ALAVANCA","ğŸ’ª Desconforto temporÃ¡rio = liberdade permanente"]};
const CATEGORIAS={receitas:['SalÃ¡rio','Freela','Investimentos','Vendas','BÃ´nus','Outros'],despesas:['Moradia','AlimentaÃ§Ã£o','Transporte','SaÃºde','EducaÃ§Ã£o','Lazer','DÃ­vidas','Outros'],investimentos:['PoupanÃ§a','Tesouro Direto','CDB','AÃ§Ãµes','Fundos','Cripto','Outros']};
class GestaoFinanceira {
// DEPOIS
constructor() {
    this.paginaAtual = 'dashboard';
    this.transacoes = [];
    this.metas = [];
    this.orcamento = {essencial: 50, investimento: 30, estilo_vida: 20};
    this.inicializar();
}

async inicializar() {
    await this.carregarDados();
    this.render();
}
    abrirModalTransacao(tipo = 'receita') {
        document.getElementById('tituloModalTransacao').textContent = tipo === 'receita' ? 'ğŸ’° Nova Receita' : tipo === 'despesa' ? 'ğŸ’¸ Nova Despesa' : 'ğŸ“ˆ Novo Investimento';
        const categorias = tipo === 'receita' ? CATEGORIAS.receitas : tipo === 'despesa' ? CATEGORIAS.despesas : CATEGORIAS.investimentos;
        document.getElementById('conteudoModalTransacao').innerHTML = `
            <div class="space-y-4">
                <div><label class="block text-sm font-semibold mb-2">ğŸ“ DescriÃ§Ã£o</label><input type="text" id="descTransacao" class="w-full px-4 py-2 rounded-lg cm-input" placeholder="Ex: SalÃ¡rio de fevereiro"></div>
                <div><label class="block text-sm font-semibold mb-2">ğŸ’µ Valor (R$)</label><input type="number" id="valorTransacao" class="w-full px-4 py-2 rounded-lg cm-input" placeholder="0.00" step="0.01"></div>
                <div><label class="block text-sm font-semibold mb-2">ğŸ“ Categoria</label><select id="categoriaTransacao" class="w-full px-4 py-2 rounded-lg cm-input">${categorias.map(c => `<option value="${c}">${c}</option>`).join('')}</select></div>
                <div><label class="block text-sm font-semibold mb-2">ğŸ“… Data</label><input type="date" id="dataTransacao" value="${new Date().toISOString().split('T')[0]}" class="w-full px-4 py-2 rounded-lg cm-input"></div>
                <div><label class="block text-sm font-semibold mb-2">ğŸ” Recorrente?</label><select id="recorrenteTransacao" class="w-full px-4 py-2 rounded-lg cm-input"><option value="false">NÃ£o</option><option value="mensal">Mensal</option><option value="semanal">Semanal</option></select></div>
                <button onclick="app.salvarTransacao('${tipo}')" class="w-full bg-cm-laranja text-white py-3 rounded-lg font-bold text-lg hover:opacity-90">ğŸ’¾ Salvar</button>
            </div>`;
        document.getElementById('modalTransacao').classList.add('ativo');
    }

  // DEPOIS
async salvarTransacao(tipo) {
        const transacao = {id: Date.now(), tipo, descricao: document.getElementById('descTransacao').value, valor: parseFloat(document.getElementById('valorTransacao').value), categoria: document.getElementById('categoriaTransacao').value, data: document.getElementById('dataTransacao').value, recorrente: document.getElementById('recorrenteTransacao').value, paga: tipo === 'despesa' ? false : true, criado_em: new Date().toISOString()};
        if (!transacao.descricao || !transacao.valor || transacao.valor <= 0) { alert('âŒ Preencha descriÃ§Ã£o e valor vÃ¡lido!'); return; }
        this.transacoes.push(transacao);
// DEPOIS
await this.salvarDados();
this.fecharModal('modalTransacao');
        alert('âœ… TransaÃ§Ã£o registrada!');
        this.render();
    }

    // DEPOIS
async marcarComoPaga(id) {
        const transacao = this.transacoes.find(t => t.id === id);
        if (transacao && transacao.tipo === 'despesa') {
            transacao.paga = !transacao.paga;
            transacao.dataPagamento = transacao.paga ? new Date().toISOString() : null;
            // DEPOIS
await this.salvarDados();
this.render();
        }
    }

    // DEPOIS
async excluirTransacao(id) {
        if (confirm('Excluir esta transaÃ§Ã£o?')) {
            this.transacoes = this.transacoes.filter(t => t.id !== id);
            // DEPOIS
await this.salvarDados();
this.render();
        }
    }

abrirModalMeta() {
    document.getElementById('conteudoModalMeta').innerHTML = `
        <div class="space-y-4">
            <div><label class="block text-sm font-semibold mb-2">ğŸ¯ Objetivo da Meta</label><input type="text" id="objetivoMeta" class="w-full px-4 py-2 rounded-lg cm-input" placeholder="Ex: Pagar dÃ­vida do cartÃ£o"></div>
            <div><label class="block text-sm font-semibold mb-2">ğŸ’° Valor Total (R$)</label><input type="number" id="valorMeta" class="w-full px-4 py-2 rounded-lg cm-input" placeholder="5000.00" step="0.01"></div>
            <div><label class="block text-sm font-semibold mb-2">ğŸ“… Prazo (dias)</label><select id="prazoMeta" class="w-full px-4 py-2 rounded-lg cm-input"><option value="7">7 dias</option><option value="15">15 dias</option><option value="30" selected>30 dias</option><option value="60">60 dias</option><option value="90">90 dias</option><option value="180">180 dias</option></select></div>
            <div><label class="block text-sm font-semibold mb-2">ğŸ¨ Tipo de Meta</label><select id="tipoMeta" class="w-full px-4 py-2 rounded-lg cm-input"><option value="economizar">ğŸ’° Economizar</option><option value="pagar_divida">ğŸ”¥ Pagar DÃ­vida</option><option value="investir">ğŸ“ˆ Investir</option><option value="renda_extra">ğŸ’¼ Renda Extra</option></select></div>
            <div><label class="block text-sm font-semibold mb-2">ğŸ“ EstratÃ©gia</label><textarea id="estrategiaMeta" class="w-full px-4 py-2 rounded-lg cm-input" rows="3"></textarea></div>
            <button onclick="app.salvarMeta()" class="w-full bg-cm-laranja text-white py-3 rounded-lg font-bold text-lg">ğŸ¯ Criar Meta</button>
        </div>`;
    document.getElementById('modalMeta').classList.add('ativo');
}

    // DEPOIS
async salvarMeta() {
        const meta = {id: Date.now(), objetivo: document.getElementById('objetivoMeta').value, valorTotal: parseFloat(document.getElementById('valorMeta').value), valorAtual: 0, prazo: parseInt(document.getElementById('prazoMeta').value), tipo: document.getElementById('tipoMeta').value, estrategia: document.getElementById('estrategiaMeta').value, dataInicio: new Date().toISOString(), status: 'ativa'};
        if (!meta.objetivo || !meta.valorTotal || meta.valorTotal <= 0) { alert('âŒ Preencha objetivo e valor vÃ¡lido!'); return; }
        meta.dataFim = new Date(Date.now() + meta.prazo * 24 * 60 * 60 * 1000).toISOString();
        meta.valorDiario = meta.valorTotal / meta.prazo;
        this.metas.push(meta);
       // DEPOIS
await this.salvarDados();
this.fecharModal('modalMeta');
        alert(`âœ… Meta criada! R$ ${meta.valorDiario.toFixed(2)}/dia`);
        this.render();
    }

    // DEPOIS
async atualizarProgressoMeta(metaId) {
        const valor = parseFloat(prompt('Quanto vocÃª progrediu? (R$)'));
        if (!valor || valor <= 0) return;
        const meta = this.metas.find(m => m.id === metaId);
        if (meta) {
            meta.valorAtual += valor;
            if (meta.valorAtual >= meta.valorTotal) { meta.status = 'concluida'; alert('ğŸ‰ PARABÃ‰NS! Meta concluÃ­da!'); }
           // DEPOIS
await this.salvarDados();
this.render();
        }
    }

 // DEPOIS
async excluirMeta(id) {
        if (confirm('Excluir esta meta?')) {
            this.metas = this.metas.filter(m => m.id !== id);
           // DEPOIS
await this.salvarDados();
this.render();
        }
    }

    calcularResumo(periodo = 'mes') {
        const hoje = new Date();
        const filtradas = this.transacoes.filter(t => {
            const dataTransacao = new Date(t.data);
            if (periodo === 'mes') return dataTransacao.getMonth() === hoje.getMonth() && dataTransacao.getFullYear() === hoje.getFullYear();
            if (periodo === 'semana') {
                const diffTime = Math.abs(hoje - dataTransacao);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                return diffDays <= 7;
            }
            return true;
        });
        const receitas = filtradas.filter(t => t.tipo === 'receita').reduce((s, t) => s + t.valor, 0);
        const despesas = filtradas.filter(t => t.tipo === 'despesa' && t.paga).reduce((s, t) => s + t.valor, 0);
        const despesasPendentes = filtradas.filter(t => t.tipo === 'despesa' && !t.paga).reduce((s, t) => s + t.valor, 0);
        const investimentos = filtradas.filter(t => t.tipo === 'investimento').reduce((s, t) => s + t.valor, 0);
        const saldo = receitas - despesas - investimentos;
        const taxaInvestimento = receitas > 0 ? ((investimentos / receitas) * 100).toFixed(1) : 0;
        const taxaGastos = receitas > 0 ? ((despesas / receitas) * 100).toFixed(1) : 0;
        return {receitas, despesas, investimentos, saldo, taxaInvestimento, taxaGastos, total: filtradas.length, despesasPendentes};
    }

    calcularPorCategoria() {
        const porCategoria = {};
        this.transacoes.forEach(t => {
            if (!porCategoria[t.categoria]) porCategoria[t.categoria] = {total: 0, count: 0};
            porCategoria[t.categoria].total += t.valor;
            porCategoria[t.categoria].count++;
        });
        return Object.entries(porCategoria).sort((a, b) => b[1].total - a[1].total).slice(0, 10);
    }

// DEPOIS
async lancamentoRapido() {
        const desc = document.getElementById('quickDesc').value;
        const valor = parseFloat(document.getElementById('quickValor').value);
        const tipo = document.getElementById('quickTipo').value;
        if (!desc || !valor || valor <= 0) { alert('âŒ Preencha descriÃ§Ã£o e valor!'); return; }
        this.transacoes.push({id: Date.now(), tipo, descricao: desc, valor, categoria: 'Outros', data: new Date().toISOString().split('T')[0], recorrente: 'false', paga: tipo === 'despesa' ? false : true, criado_em: new Date().toISOString()});
      // DEPOIS
await this.salvarDados();
document.getElementById('quickDesc').value = '';
        document.getElementById('quickValor').value = '';
        alert('âœ… LanÃ§ado!');
        this.render();
    }

    calcularDividasAtrasadas() {
        const hoje = new Date();
        const atrasadas = this.transacoes.filter(t => {
            if (t.tipo !== 'despesa' || t.paga) return false;
            const dataTransacao = new Date(t.data);
            return dataTransacao < hoje;
        });
        const valorTotal = atrasadas.reduce((s, t) => s + t.valor, 0);
        return {quantidade: atrasadas.length, valor: valorTotal};
    }

    calcularDiasRestantes() {
        const hoje = new Date();
        const ultimoDia = new Date(hoje.getFullYear(), hoje.getMonth() + 1, 0);
        return ultimoDia.getDate() - hoje.getDate();
    }

    exportarCSV() {
        let csv = 'Data,Tipo,Categoria,DescriÃ§Ã£o,Valor\n';
        this.transacoes.sort((a, b) => new Date(b.data) - new Date(a.data)).forEach(t => { csv += `${t.data},${t.tipo},${t.categoria},"${t.descricao}",${t.valor}\n`; });
        const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `financas_${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
        alert('âœ… Planilha exportada!');
    }

    exportarJSON() {
        const dados = {transacoes: this.transacoes, metas: this.metas, orcamento: this.orcamento, exportado_em: new Date().toISOString()};
        const blob = new Blob([JSON.stringify(dados, null, 2)], {type: 'application/json'});
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `backup_financeiro_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        alert('âœ… Backup exportado!');
    }

  async salvarDados() {
    await MVData.salvar('financeiro', {
        tipo: 'transacoes',
        dados: this.transacoes
    });
    await MVData.salvar('financeiro', {
        tipo: 'metas',
        dados: this.metas
    });
    await MVData.salvar('financeiro', {
        tipo: 'orcamento',
        dados: this.orcamento
    });
}

 // DEPOIS
async carregarDados() {
    const transacoes = await MVData.buscar('financeiro', { tipo: 'transacoes' });
    if (transacoes.length) this.transacoes = transacoes[0].dados || [];

    const metas = await MVData.buscar('financeiro', { tipo: 'metas' });
    if (metas.length) this.metas = metas[0].dados || [];

    const orcamento = await MVData.buscar('financeiro', { tipo: 'orcamento' });
    if (orcamento.length) this.orcamento = orcamento[0].dados || {};
}

  
   // DEPOIS
async limparDados() {
    if (confirm('âš ï¸ Apagar TODOS os dados?') && confirm('Tem certeza?')) {
        const registros = await MVData.buscar('financeiro');
        for (const r of registros) {
            await MVData.deletar('financeiro', r.id);
        }
        localStorage.removeItem('mv_financeiro');
        this.transacoes = [];
        this.metas = [];
        this.orcamento = {};
        alert('âœ… Dados limpos!');
        this.render();
    }
}

  
    fecharModal(id) {
        document.getElementById(id).classList.remove('ativo');
    }

    render() {
        const app = document.getElementById('app');
        const pages = {'dashboard': () => this.renderDashboard(), 'transacoes': () => this.renderTransacoes(), 'metas': () => this.renderMetas(), 'alavancagem': () => this.renderAlavancagem(), 'relatorios': () => this.renderRelatorios()};
        app.innerHTML = pages[this.paginaAtual]();
    }

    renderMenu(ativo) {
        const menus = [{id:'dashboard',label:'ğŸ“Š Dashboard'},{id:'transacoes',label:'ğŸ’° TransaÃ§Ãµes'},{id:'metas',label:'ğŸ¯ Metas'},{id:'alavancagem',label:'ğŸš€ Alavancagem'},{id:'relatorios',label:'ğŸ“ˆ RelatÃ³rios'}];
        return `<div class="bg-cm-azul-claro shadow-md border-b-4 border-cm-laranja sticky top-0 z-40"><div class="max-w-7xl mx-auto flex gap-2 px-4 py-3 overflow-x-auto">${menus.map(m => `<button onclick="app.paginaAtual='${m.id}';app.render();" class="px-6 py-3 rounded-lg font-bold whitespace-nowrap text-sm transition-all ${ativo === m.id ? 'bg-gradient-to-r from-cm-laranja to-cm-laranja-escuro text-white shadow-lg scale-105' : 'bg-cm-bege text-cm-verde-escuro hover:bg-cm-laranja hover:text-white'}">${m.label}</button>`).join('')}</div></div>`;
    }

 renderDashboard(){
    const resumo=this.calcularResumo('mes');
    const diasRestantes=this.calcularDiasRestantes();
    const metasAtivas=this.metas.filter(m=>m.status==='ativa');
    const dividas=this.calcularDividasAtrasadas();
    const fmt=(v)=>v.toLocaleString('pt-BR',{minimumFractionDigits:2});
    return `
    <div style="background:#0a0a0f;min-height:100vh;padding-bottom:60px;">
      <div style="background:linear-gradient(135deg,#1a0533,#0d1f3c);border-bottom:2px solid #7c3aed;padding:24px 28px;">
        <div style="display:flex;align-items:center;gap:16px;">
          <div style="background:#7c3aed;color:#fff;font-weight:800;font-size:18px;padding:10px 16px;border-radius:10px;font-family:'Syne',sans-serif;">MV</div>
          <div>
            <h1 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:#e2e8f0;">ğŸ’¼ Dashboard Financeiro</h1>
            <p style="color:#94a3b8;font-size:13px;margin-top:2px;">MEGAVISION Financial Pro</p>
          </div>
        </div>
      </div>
      ${this.renderMenu('dashboard')}
      <div style="max-width:1200px;margin:0 auto;padding:24px 20px;">

        <!-- Saldo Banner -->
        <div style="background:linear-gradient(135deg,#1a0533,#0d1f3c);border:1px solid #7c3aed;border-radius:12px;padding:20px 24px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;">
          <div>
            <div style="color:#94a3b8;font-size:12px;text-transform:uppercase;letter-spacing:.8px;">Fevereiro 2026 Â· ${diasRestantes} dias restantes</div>
            <div style="color:#e2e8f0;font-family:'Syne',sans-serif;font-size:20px;font-weight:800;margin-top:4px;">MEGAVISION Financial Pro</div>
          </div>
          <div style="text-align:right;">
            <div style="color:#94a3b8;font-size:12px;">Saldo do MÃªs</div>
            <div style="font-family:'Syne',sans-serif;font-size:28px;font-weight:800;color:${resumo.saldo>=0?'#34d399':'#f87171'};">${resumo.saldo>=0?'ğŸ’°':'âš ï¸'} R$ ${fmt(resumo.saldo)}</div>
          </div>
        </div>

        <!-- KPIs -->
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:20px;">
          <div style="background:#111118;border:1px solid #1e1e2e;border-left:4px solid #10b981;border-radius:12px;padding:18px;">
            <div style="color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;">ğŸ’° Receitas</div>
            <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:#34d399;margin-top:6px;">R$ ${fmt(resumo.receitas)}</div>
          </div>
          <div style="background:#111118;border:1px solid #1e1e2e;border-left:4px solid #ef4444;border-radius:12px;padding:18px;">
            <div style="color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;">ğŸ’¸ Despesas</div>
            <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:#f87171;margin-top:6px;">R$ ${fmt(resumo.despesas)}</div>
          </div>
          <div style="background:#111118;border:1px solid #1e1e2e;border-left:4px solid #f59e0b;border-radius:12px;padding:18px;">
            <div style="color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;">ğŸ“ˆ Investimentos</div>
            <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:#fbbf24;margin-top:6px;">R$ ${fmt(resumo.investimentos)}</div>
          </div>
        </div>

        <!-- Indicadores -->
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:20px;">
          ${[
            {label:'Taxa Investimento',valor:`${resumo.taxaInvestimento}%`,sub:'Meta: 30%',cor:'#a78bfa'},
            {label:'TransaÃ§Ãµes',valor:resumo.total,sub:'Este mÃªs',cor:'#06b6d4'},
            {label:'Metas Ativas',valor:metasAtivas.length,sub:'Em progresso',cor:'#7c3aed'},
            {label:dividas.quantidade>0?'Contas Atrasadas':'Contas OK',valor:dividas.quantidade>0?dividas.quantidade:'âœ“',sub:dividas.quantidade>0?`R$ ${fmt(dividas.valor)}`:'Tudo certo',cor:dividas.quantidade>0?'#ef4444':'#10b981'}
          ].map(k=>`
            <div style="background:#111118;border:1px solid #1e1e2e;border-radius:12px;padding:16px 18px;border-left:4px solid ${k.cor};">
              <div style="color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.6px;">${k.label}</div>
              <div style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:${k.cor};margin-top:4px;">${k.valor}</div>
              <div style="color:#64748b;font-size:11px;margin-top:2px;">${k.sub}</div>
            </div>
          `).join('')}
        </div>

        <!-- Alerta pendentes -->
        ${resumo.despesasPendentes>0?`
          <div style="background:rgba(239,68,68,.12);border:1px solid rgba(239,68,68,.3);border-left:4px solid #ef4444;border-radius:12px;padding:16px 20px;margin-bottom:20px;display:flex;align-items:center;gap:16px;">
            <span style="font-size:24px;">âš ï¸</span>
            <div style="flex:1;">
              <div style="color:#f87171;font-weight:700;">Despesas Pendentes</div>
              <div style="color:#fca5a5;font-size:13px;margin-top:2px;">R$ ${fmt(resumo.despesasPendentes)} em contas nÃ£o pagas</div>
            </div>
            <button onclick="app.paginaAtual='transacoes';app.render();" style="background:#ef4444;color:#fff;padding:8px 16px;border-radius:8px;font-weight:600;border:none;cursor:pointer;">Ver Contas</button>
          </div>
        `:''}

        <!-- BotÃµes de aÃ§Ã£o -->
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:20px;">
          <button onclick="app.abrirModalTransacao('receita')" style="background:linear-gradient(135deg,#059669,#10b981);color:#fff;padding:20px;border-radius:12px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;">
            <div style="font-size:32px;margin-bottom:8px;">ğŸ’°</div>Nova Receita
          </button>
          <button onclick="app.abrirModalTransacao('despesa')" style="background:linear-gradient(135deg,#dc2626,#ef4444);color:#fff;padding:20px;border-radius:12px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;">
            <div style="font-size:32px;margin-bottom:8px;">ğŸ’¸</div>Nova Despesa
          </button>
          <button onclick="app.abrirModalTransacao('investimento')" style="background:linear-gradient(135deg,#7c3aed,#6d28d9);color:#fff;padding:20px;border-radius:12px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;">
            <div style="font-size:32px;margin-bottom:8px;">ğŸ“ˆ</div>Investimento
          </button>
        </div>

        <!-- LanÃ§amento RÃ¡pido -->
        <div style="background:#111118;border:1px solid #7c3aed;border-radius:12px;padding:20px;">
          <div style="display:flex;align-items:center;gap:12px;margin-bottom:16px;">
            <div style="background:#7c3aed;color:#fff;padding:10px;border-radius:8px;font-size:18px;">âš¡</div>
            <h3 style="font-family:'Syne',sans-serif;font-size:16px;font-weight:800;color:#e2e8f0;">LanÃ§amento RÃ¡pido</h3>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr auto;gap:12px;">
            <input type="text" id="quickDesc" placeholder="DescriÃ§Ã£o" style="background:#0a0a0f;border:1px solid #7c3aed;border-radius:8px;color:#e2e8f0;padding:10px 14px;font-size:14px;outline:none;">
            <input type="number" id="quickValor" placeholder="R$ 0,00" step="0.01" style="background:#0a0a0f;border:1px solid #7c3aed;border-radius:8px;color:#e2e8f0;padding:10px 14px;font-size:14px;outline:none;">
            <select id="quickTipo" style="background:#0a0a0f;border:1px solid #7c3aed;border-radius:8px;color:#e2e8f0;padding:10px 14px;font-size:14px;outline:none;">
              <option value="despesa" style="background:#111118;">ğŸ’¸ Despesa</option>
              <option value="receita" style="background:#111118;">ğŸ’° Receita</option>
              <option value="investimento" style="background:#111118;">ğŸ“ˆ Investimento</option>
            </select>
            <button onclick="app.lancamentoRapido()" style="background:#7c3aed;color:#fff;padding:10px 20px;border-radius:8px;font-weight:700;font-size:14px;border:none;cursor:pointer;white-space:nowrap;">âš¡ LANÃ‡AR</button>
          </div>
        </div>

      </div>
    </div>`;
  }

  renderTransacoes(){
    const ultimas=[...this.transacoes].sort((a,b)=>new Date(b.data)-new Date(a.data)).slice(0,50);
    const fmt=(v)=>v.toLocaleString('pt-BR',{minimumFractionDigits:2});
    return `
    <div style="background:#0a0a0f;min-height:100vh;padding-bottom:60px;">
      <div style="background:linear-gradient(135deg,#1a0533,#0d1f3c);border-bottom:2px solid #7c3aed;padding:24px 28px;">
        <div style="display:flex;align-items:center;gap:16px;">
          <div style="background:#7c3aed;color:#fff;font-weight:800;font-size:18px;padding:10px 16px;border-radius:10px;font-family:'Syne',sans-serif;">MV</div>
          <div><h1 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:#e2e8f0;">ğŸ’° TransaÃ§Ãµes</h1><p style="color:#94a3b8;font-size:13px;">MEGAVISION Financial Pro</p></div>
        </div>
      </div>
      ${this.renderMenu('transacoes')}
      <div style="max-width:1200px;margin:0 auto;padding:24px 20px;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
          <h2 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:18px;font-weight:700;">HistÃ³rico (${this.transacoes.length})</h2>
          <div style="display:flex;gap:10px;">
            <button onclick="app.abrirModalTransacao('receita')" style="background:#10b981;color:#fff;padding:8px 16px;border-radius:8px;font-weight:600;border:none;cursor:pointer;">â• Receita</button>
            <button onclick="app.abrirModalTransacao('despesa')" style="background:#ef4444;color:#fff;padding:8px 16px;border-radius:8px;font-weight:600;border:none;cursor:pointer;">â• Despesa</button>
            <button onclick="app.abrirModalTransacao('investimento')" style="background:#7c3aed;color:#fff;padding:8px 16px;border-radius:8px;font-weight:600;border:none;cursor:pointer;">â• Investimento</button>
          </div>
        </div>
        ${ultimas.length===0?`
          <div style="background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);border-left:4px solid #f59e0b;border-radius:12px;padding:24px;">
            <h3 style="color:#fbbf24;font-family:'Syne',sans-serif;font-size:16px;font-weight:700;">ğŸ“ Comece Agora!</h3>
            <p style="color:#94a3b8;margin-top:8px;">Registre sua primeira transaÃ§Ã£o.</p>
          </div>
        `:`
          <div style="background:#111118;border:1px solid #1e1e2e;border-radius:12px;overflow:hidden;">
            <table style="width:100%;border-collapse:collapse;">
              <thead>
                <tr style="background:#1e1e2e;">
                  <th style="padding:12px 16px;text-align:left;color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;font-weight:700;">Data</th>
                  <th style="padding:12px 16px;text-align:left;color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;font-weight:700;">DescriÃ§Ã£o</th>
                  <th style="padding:12px 16px;text-align:left;color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;font-weight:700;">Categoria</th>
                  <th style="padding:12px 16px;text-align:right;color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;font-weight:700;">Valor</th>
                  <th style="padding:12px 16px;text-align:center;color:#94a3b8;font-size:11px;text-transform:uppercase;letter-spacing:.8px;font-weight:700;">AÃ§Ãµes</th>
                </tr>
              </thead>
              <tbody>
                ${ultimas.map(t=>`
                  <tr style="border-bottom:1px solid #1e1e2e;">
                    <td style="padding:12px 16px;color:#94a3b8;font-size:13px;">${new Date(t.data).toLocaleDateString('pt-BR')}</td>
                    <td style="padding:12px 16px;"><div style="color:#e2e8f0;font-weight:600;">${t.descricao}</div>${t.recorrente!=='false'?`<div style="color:#64748b;font-size:11px;">ğŸ” ${t.recorrente}</div>`:''}</td>
                    <td style="padding:12px 16px;"><span style="background:#1e1e2e;color:#94a3b8;padding:4px 10px;border-radius:20px;font-size:11px;font-weight:600;">${t.categoria}</span></td>
                    <td style="padding:12px 16px;text-align:right;"><span style="font-family:'Syne',sans-serif;font-weight:800;color:${t.tipo==='receita'?'#34d399':'#f87171'};">${t.tipo==='receita'?'+':'-'} R$ ${fmt(t.valor)}</span></td>
                    <td style="padding:12px 16px;text-align:center;">
                      ${t.tipo==='despesa'?`<input type="checkbox" ${t.paga?'checked':''} onclick="app.marcarComoPaga(${t.id})" style="width:18px;height:18px;cursor:pointer;margin-right:8px;accent-color:#7c3aed;">`:'' }
                      <button onclick="app.excluirTransacao(${t.id})" style="background:rgba(239,68,68,.15);color:#f87171;border:1px solid rgba(239,68,68,.3);padding:4px 10px;border-radius:6px;cursor:pointer;font-size:13px;">ğŸ—‘ï¸</button>
                    </td>
                  </tr>`).join('')}
              </tbody>
            </table>
          </div>
          <div style="display:flex;gap:12px;margin-top:16px;">
            <button onclick="app.exportarCSV()" style="background:#10b981;color:#fff;padding:10px 20px;border-radius:8px;font-weight:600;border:none;cursor:pointer;">ğŸ“¥ Exportar CSV</button>
            <button onclick="app.exportarJSON()" style="background:#7c3aed;color:#fff;padding:10px 20px;border-radius:8px;font-weight:600;border:none;cursor:pointer;">ğŸ’¾ Backup JSON</button>
          </div>
        `}
      </div>
    </div>`;
  }

  renderMetas(){
    const ativas=this.metas.filter(m=>m.status==='ativa');
    const concluidas=this.metas.filter(m=>m.status==='concluida');
    const fmt=(v)=>v.toLocaleString('pt-BR',{minimumFractionDigits:2});
    return `
    <div style="background:#0a0a0f;min-height:100vh;padding-bottom:60px;">
      <div style="background:linear-gradient(135deg,#1a0533,#0d1f3c);border-bottom:2px solid #7c3aed;padding:24px 28px;">
        <div style="display:flex;align-items:center;gap:16px;">
          <div style="background:#7c3aed;color:#fff;font-weight:800;font-size:18px;padding:10px 16px;border-radius:10px;font-family:'Syne',sans-serif;">MV</div>
          <div><h1 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:#e2e8f0;">ğŸ¯ Metas Financeiras</h1><p style="color:#94a3b8;font-size:13px;">MEGAVISION Financial Pro</p></div>
        </div>
      </div>
      ${this.renderMenu('metas')}
      <div style="max-width:1200px;margin:0 auto;padding:24px 20px;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
          <h2 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:18px;font-weight:700;">Suas Metas</h2>
          <button onclick="app.abrirModalMeta()" style="background:#7c3aed;color:#fff;padding:10px 20px;border-radius:8px;font-weight:700;border:none;cursor:pointer;">â• Nova Meta</button>
        </div>
        ${ativas.length>0?`
          <h3 style="color:#f59e0b;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin-bottom:14px;">ğŸ”¥ Em Progresso</h3>
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:28px;">
            ${ativas.map(meta=>{
              const prog=(meta.valorAtual/meta.valorTotal*100).toFixed(1);
              const dias=meta.prazo-Math.floor((new Date()-new Date(meta.dataInicio))/(1000*60*60*24));
              return `<div style="background:#111118;border:1px solid #1e1e2e;border-top:4px solid #7c3aed;border-radius:12px;padding:20px;">
                <div style="display:flex;justify-content:space-between;margin-bottom:14px;">
                  <h4 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:16px;font-weight:800;">${meta.objetivo}</h4>
                  <button onclick="app.excluirMeta(${meta.id})" style="background:rgba(239,68,68,.15);color:#f87171;border:1px solid rgba(239,68,68,.3);padding:4px 10px;border-radius:6px;cursor:pointer;font-size:12px;">ğŸ—‘ï¸</button>
                </div>
                <div style="display:flex;justify-content:space-between;color:#94a3b8;font-size:12px;margin-bottom:6px;">
                  <span>R$ ${fmt(meta.valorAtual)} / R$ ${fmt(meta.valorTotal)}</span>
                  <span style="color:#a78bfa;font-weight:700;">${prog}%</span>
                </div>
                <div style="background:#1e1e2e;border-radius:20px;height:10px;margin-bottom:14px;">
                  <div style="background:linear-gradient(90deg,#7c3aed,#10b981);height:10px;border-radius:20px;width:${Math.min(prog,100)}%;"></div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px;">
                  <div style="background:#0a0a0f;border:1px solid #1e1e2e;border-radius:8px;padding:12px;text-align:center;">
                    <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:#a78bfa;">${dias}</div>
                    <div style="color:#64748b;font-size:11px;">dias restantes</div>
                  </div>
                  <div style="background:#0a0a0f;border:1px solid #1e1e2e;border-radius:8px;padding:12px;text-align:center;">
                    <div style="font-family:'Syne',sans-serif;font-size:16px;font-weight:800;color:#a78bfa;">R$ ${meta.valorDiario.toFixed(2)}</div>
                    <div style="color:#64748b;font-size:11px;">por dia</div>
                  </div>
                </div>
                <button onclick="app.atualizarProgressoMeta(${meta.id})" style="width:100%;background:#10b981;color:#fff;padding:12px;border-radius:8px;font-weight:700;border:none;cursor:pointer;">â• Atualizar Progresso</button>
              </div>`;
            }).join('')}
          </div>
        `:''}
        ${concluidas.length>0?`
          <h3 style="color:#10b981;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;margin-bottom:14px;">âœ… ConcluÃ­das</h3>
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px;">
            ${concluidas.map(m=>`
              <div style="background:rgba(16,185,129,.08);border:1px solid rgba(16,185,129,.3);border-radius:12px;padding:16px;">
                <div style="color:#34d399;font-weight:700;">${m.objetivo}</div>
                <div style="color:#94a3b8;font-size:12px;margin-top:6px;">R$ ${m.valorTotal.toLocaleString('pt-BR')}</div>
              </div>`).join('')}
          </div>
        `:''}
        ${ativas.length===0&&concluidas.length===0?`
          <div style="background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);border-left:4px solid #f59e0b;border-radius:12px;padding:32px;text-align:center;">
            <div style="font-size:48px;margin-bottom:12px;">ğŸ¯</div>
            <h3 style="color:#fbbf24;font-family:'Syne',sans-serif;font-size:18px;font-weight:700;margin-bottom:8px;">Crie sua Primeira Meta!</h3>
            <button onclick="app.abrirModalMeta()" style="background:#7c3aed;color:#fff;padding:12px 24px;border-radius:8px;font-weight:700;border:none;cursor:pointer;margin-top:12px;">â• Criar Meta</button>
          </div>
        `:''}
      </div>
    </div>`;
  }

  renderAlavancagem(){
    return `
    <div style="background:#0a0a0f;min-height:100vh;padding-bottom:60px;">
      <div style="background:linear-gradient(135deg,#1a0533,#0d1f3c);border-bottom:2px solid #7c3aed;padding:24px 28px;">
        <div style="display:flex;align-items:center;gap:16px;">
          <div style="background:#7c3aed;color:#fff;font-weight:800;font-size:18px;padding:10px 16px;border-radius:10px;font-family:'Syne',sans-serif;">MV</div>
          <div><h1 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:#e2e8f0;">ğŸš€ TÃ©cnicas de Alavancagem</h1><p style="color:#94a3b8;font-size:13px;">EstratÃ©gias Comprovadas</p></div>
        </div>
      </div>
      ${this.renderMenu('alavancagem')}
      <div style="max-width:1200px;margin:0 auto;padding:24px 20px;">
        <div style="background:linear-gradient(135deg,#1a0533,#0d1f3c);border:1px solid #7c3aed;border-radius:12px;padding:28px;margin-bottom:24px;">
          <h2 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:22px;font-weight:800;margin-bottom:16px;">âš¡ 7 Regras de Ouro</h2>
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;">
            ${TECNICAS_ALAVANCAGEM.regras_ouro.map(r=>`
              <div style="background:rgba(124,58,237,.15);border:1px solid rgba(124,58,237,.3);border-radius:8px;padding:14px;">
                <p style="color:#e2e8f0;font-weight:600;font-size:14px;">${r}</p>
              </div>`).join('')}
          </div>
        </div>
        ${[TECNICAS_ALAVANCAGEM.curto_prazo, TECNICAS_ALAVANCAGEM.medio_prazo].map(grupo=>`
          <div style="background:#111118;border:1px solid #1e1e2e;border-top:4px solid #7c3aed;border-radius:12px;padding:24px;margin-bottom:20px;">
            <h2 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:20px;font-weight:800;margin-bottom:20px;">${grupo.titulo}</h2>
            <div style="display:flex;flex-direction:column;gap:16px;">
              ${grupo.tecnicas.map(t=>`
                <div style="background:#0a0a0f;border:1px solid #1e1e2e;border-radius:10px;padding:20px;">
                  <h3 style="font-family:'Syne',sans-serif;color:#a78bfa;font-size:17px;font-weight:800;margin-bottom:14px;">ğŸ’¡ ${t.nome}</h3>
                  <div style="display:flex;flex-direction:column;gap:8px;">
                    <div style="background:rgba(6,182,212,.1);border-left:4px solid #06b6d4;border-radius:0 8px 8px 0;padding:12px 16px;">
                      <span style="color:#22d3ee;font-weight:700;font-size:12px;">ğŸ“– O QUE Ã‰</span>
                      <p style="color:#e2e8f0;font-size:13px;margin-top:4px;">${t.descricao}</p>
                    </div>
                    <div style="background:rgba(16,185,129,.1);border-left:4px solid #10b981;border-radius:0 8px 8px 0;padding:12px 16px;">
                      <span style="color:#34d399;font-weight:700;font-size:12px;">ğŸ¯ COMO FAZER</span>
                      <p style="color:#e2e8f0;font-size:13px;margin-top:4px;">${t.acao}</p>
                    </div>
                    <div style="background:rgba(245,158,11,.1);border-left:4px solid #f59e0b;border-radius:0 8px 8px 0;padding:12px 16px;">
                      <span style="color:#fbbf24;font-weight:700;font-size:12px;">ğŸ“ˆ IMPACTO</span>
                      <p style="color:#e2e8f0;font-size:13px;margin-top:4px;">${t.impacto}</p>
                    </div>
                  </div>
                </div>`).join('')}
            </div>
          </div>`).join('')}
      </div>
    </div>`;
  }

  renderRelatorios(){
    const resumo=this.calcularResumo('mes');
    const porCategoria=this.calcularPorCategoria();
    const fmt=(v)=>v.toLocaleString('pt-BR',{minimumFractionDigits:2});
    return `
    <div style="background:#0a0a0f;min-height:100vh;padding-bottom:60px;">
      <div style="background:linear-gradient(135deg,#1a0533,#0d1f3c);border-bottom:2px solid #7c3aed;padding:24px 28px;">
        <div style="display:flex;align-items:center;gap:16px;">
          <div style="background:#7c3aed;color:#fff;font-weight:800;font-size:18px;padding:10px 16px;border-radius:10px;font-family:'Syne',sans-serif;">MV</div>
          <div><h1 style="font-family:'Syne',sans-serif;font-size:24px;font-weight:800;color:#e2e8f0;">ğŸ“ˆ RelatÃ³rios</h1><p style="color:#94a3b8;font-size:13px;">MEGAVISION Financial Pro</p></div>
        </div>
      </div>
      ${this.renderMenu('relatorios')}
      <div style="max-width:1200px;margin:0 auto;padding:24px 20px;">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
          <div style="background:#111118;border:1px solid #1e1e2e;border-top:4px solid #7c3aed;border-radius:12px;padding:24px;">
            <h3 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:16px;font-weight:700;margin-bottom:16px;">ğŸ’° Fluxo de Caixa</h3>
            <div style="display:flex;flex-direction:column;gap:10px;">
              ${[
                {label:'ğŸ’° Receitas',valor:fmt(resumo.receitas),cor:'#10b981'},
                {label:'ğŸ’¸ Despesas',valor:fmt(resumo.despesas),cor:'#ef4444'},
                {label:'ğŸ“ˆ Investimentos',valor:fmt(resumo.investimentos),cor:'#06b6d4'},
              ].map(i=>`
                <div style="display:flex;justify-content:space-between;align-items:center;background:#0a0a0f;border:1px solid #1e1e2e;border-left:4px solid ${i.cor};border-radius:8px;padding:12px 16px;">
                  <span style="color:#e2e8f0;font-weight:600;">${i.label}</span>
                  <span style="font-family:'Syne',sans-serif;font-weight:800;color:${i.cor};">R$ ${i.valor}</span>
                </div>`).join('')}
              <div style="display:flex;justify-content:space-between;align-items:center;background:linear-gradient(135deg,#7c3aed,#4f46e5);border-radius:8px;padding:14px 16px;">
                <span style="color:#fff;font-weight:700;font-size:15px;">ğŸ’¼ SALDO</span>
                <span style="font-family:'Syne',sans-serif;font-weight:800;font-size:20px;color:#fff;">R$ ${fmt(resumo.saldo)}</span>
              </div>
            </div>
          </div>
          <div style="background:#111118;border:1px solid #1e1e2e;border-top:4px solid #06b6d4;border-radius:12px;padding:24px;">
            <h3 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:16px;font-weight:700;margin-bottom:16px;">ğŸ“Š Top Categorias</h3>
            ${porCategoria.length>0?`<div style="display:flex;flex-direction:column;gap:8px;">${porCategoria.map(([cat,dados],i)=>`
              <div style="display:flex;justify-content:space-between;align-items:center;background:#0a0a0f;border:1px solid #1e1e2e;border-left:4px solid #7c3aed;border-radius:8px;padding:10px 14px;">
                <div style="display:flex;align-items:center;gap:10px;">
                  <span style="background:#7c3aed;color:#fff;font-weight:800;font-size:11px;padding:3px 8px;border-radius:6px;">${i+1}</span>
                  <span style="color:#e2e8f0;font-weight:600;font-size:13px;">${cat}</span>
                </div>
                <span style="color:#a78bfa;font-weight:700;font-size:13px;">R$ ${dados.total.toLocaleString('pt-BR')}</span>
              </div>`).join('')}</div>`:`<p style="color:#64748b;text-align:center;padding:24px;">Nenhuma transaÃ§Ã£o</p>`}
          </div>
        </div>
        <div style="background:#111118;border:1px solid #1e1e2e;border-top:4px solid #10b981;border-radius:12px;padding:24px;margin-bottom:20px;">
          <h3 style="font-family:'Syne',sans-serif;color:#e2e8f0;font-size:16px;font-weight:700;margin-bottom:16px;">ğŸ“¥ Exportar Dados</h3>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;">
            <button onclick="app.exportarCSV()" style="background:linear-gradient(135deg,#059669,#10b981);color:#fff;padding:20px;border-radius:12px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;">
              <div style="font-size:36px;margin-bottom:8px;">ğŸ“Š</div>Exportar Planilha CSV
            </button>
            <button onclick="app.exportarJSON()" style="background:linear-gradient(135deg,#7c3aed,#6d28d9);color:#fff;padding:20px;border-radius:12px;border:none;cursor:pointer;font-family:'Syne',sans-serif;font-size:15px;font-weight:700;">
              <div style="font-size:36px;margin-bottom:8px;">ğŸ’¾</div>Backup Completo JSON
            </button>
          </div>
        </div>
        <div style="background:rgba(239,68,68,.08);border:2px solid rgba(239,68,68,.3);border-radius:12px;padding:24px;">
          <h3 style="font-family:'Syne',sans-serif;color:#f87171;font-size:16px;font-weight:700;margin-bottom:8px;">âš ï¸ Zona de Perigo</h3>
          <p style="color:#94a3b8;margin-bottom:16px;font-size:13px;">Cuidado! Esta aÃ§Ã£o nÃ£o pode ser desfeita.</p>
          <button onclick="app.limparDados()" style="background:#ef4444;color:#fff;padding:12px 24px;border-radius:8px;font-weight:700;border:none;cursor:pointer;">ğŸ—‘ï¸ Apagar Todos os Dados</button>
        </div>
      </div>
    </div>`;
  }
}

const app = new GestaoFinanceira();
</script>

<footer class="mv-footer">
  <span>MEGAVISION ECOSYSTEM</span> Â© 2026 â€” Todos os direitos reservados
</footer>

</body>
</html>

const app = new GestaoFinanceira();
    </script>
      <footer class="mv-footer">
  <span>MEGAVISION ECOSYSTEM</span> Â© 2026 â€” Todos os direitos reservados
</footer>
</body>
</html>
